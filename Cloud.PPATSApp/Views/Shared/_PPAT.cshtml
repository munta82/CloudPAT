<style>

</style>
<script type="text/javascript">
    $(document).ready(function () {
        $("#ddlMeasuringApp").on("change", function () {
            $("#hdnMeasuringApp").val($(this).find("option:selected").text());
        });

        $("#btnPSGo").click(function () {

            var psCodeval = $("#txtPSCode").val();
            if (psCodeval == "") {
                alert("Please enter PS Code");
                return false;
            }
            $.ajax({
                type: "POST",
                url: "/PPAT/GetPPATPollingStationData",
                dataType: "json",
                cache: false,
                async: false,
                data: {
                    PSCode: psCodeval
                },
                success: function (data) {
                    //debugger;
                    $("#ddlStates").val(data.stateCode);
                    $("#ddlParliament").val(data.pccode);
                    $("#ddlAssembly").val(data.accode);
                    $("#ddlMandal").val(data.mandalCode);
                    $("#ddlVillage").val(data.villageCode);
                    $("#txtPSName").val(data.psname);

                    $("#ddlStates").prop("disabled", true);
                    $("#ddlParliament").prop("disabled", true);
                    $("#ddlAssembly").prop("disabled", true);
                    $("#ddlMandal").prop("disabled", true);
                    $("#ddlVillage").prop("disabled", true);
                    if (data.psname == null || data.psname == "") {
                        $("#txtPSName").prop("disabled", false);
                    }
                    else {
                        $("#txtPSName").prop("disabled", true);
                    }
                    console.log(data);
                },
                error: function (jqXhr, textStatus, errorMessage) {
                    //debugger;

                    //console.log("AJAX ERROR:", data);
                }
            });
        });


        $("#txtSubCaste").autocomplete({
            source: function (request, response) {
                $.ajax({
                    type: "POST",
                    url: "/PPAT/GetPPATSubCasteData",
                    dataType: "json",
                    cache: false,
                    async: false,
                    maxShowItems: 5,
                    minLength: 2,
                    data: {
                        searchString: $("#txtSubCaste").val(),
                        communityCode: $("#ddlCommunity").val()
                    },
                    success: function (data) {
                        //debugger;
                        response($.map(data, function (item) {
                            //debugger;
                            return {
                                label: item.subCasteName,
                                value: item.subCasteCode

                            }
                        }));

                        console.log(data);
                    },
                    error: function (jqXhr, textStatus, errorMessage) {
                        //debugger;
                        if (jqXhr.responseText.indexOf('maxJsonLength') > -1) {
                            alert("Search results exceeds max records. Plese refine your search with more characters");
                        }
                    }
                });
            },
            minLength: 2,
            select: function (evet, ui) {
                //debugger;
                var subcastecode = ui.item.value;
                $("#txtSubCaste").val(ui.item.label);
            }
        });

        $("#btnSave").click(function () {
            //e.preventDefault();
            //var selectedOption = $("#CountryId option:selected").text();
            //// Add the selected drop down text to a hidden field
            //$("<input/>", { type: 'hidden', name: 'countryName' }).val(selectedOption).appendTo("#someForm");


            $("#ddlStates").prop("disabled", false);
            $("#ddlParliament").prop("disabled", false);
            $("#ddlAssembly").prop("disabled", false);
            $("#ddlMandal").prop("disabled", false);
            $("#ddlVillage").prop("disabled", false);
            $("#txtPSName").prop("disabled", false);            

            $("form").attr("action", "/PPAT/SaveForm");
        });

        $("#btnClear").click(function () {
            $("form").attr("action", "/PPAT/ClearForm");
        });

    });
</script>
@*@using (Html.BeginForm("SaveUserInfo", "PPAT"))*@
@using (Html.BeginForm())
{
    <table border="1">
        <tbody>
            <tr>
                <td>
                    @*@Html.ValidationSummary(true, "Please fix the following error and then submit the form")*@
                   <input type="hidden" id="hdnMeasuringApp" name="hdnMeasuringApp" value="" />
                    <table class="tblRoundCorner" style="width:100%">
                        <tr>
                            <td>Measuring Applications<span class="field-validation-valid field-validation-error" data-valmsg-for="ddlMeasuringApp"
      data-valmsg-replace="true">*</span></td>
                            <td>
                                @Html.DropDownList("ddlMeasuringApp", (IEnumerable<SelectListItem>)ViewBag.ddlMeasuringApp, "Select",
                                new
                                    {
                                        @class = "form-control valid PPATDropdownlist",
                               @data_val = "true",
                                        @data_val_required = " required"
                                    })
                        </tr>
                    </table>
                </td>
        </tr>
        <tr>
            <td style="height:5px;">
                @*@Html.ValidationSummary(false)*@
            </td>
        </tr>
        <tr>
            <td>
                <table border="1" style="width:100%" class="tblRoundCorner">
                    <tr>
                        <td>
                            State<span class="field-validation-valid field-validation-error" data-valmsg-for="ddlStates"
                                       data-valmsg-replace="true">*</span><br />
                            @Html.DropDownList("ddlStates", (IEnumerable<SelectListItem>)ViewBag.ddlStates, "Select",
                           new { @class = "form-control valid PPATDropdownlist", @data_val = "true", @data_val_required = " required" }) @*Parliament is*@
                        </td>
                        <td>
                            Parliament<span class="field-validation-valid field-validation-error" data-valmsg-for="ddlParliament"
      data-valmsg-replace="true">*</span><br />
                            @Html.DropDownList("ddlParliament", ViewBag.ddlParliament as SelectList, "Select",
                           new { @class = "form-control PPATDropdownlist valid", @data_val = "true", @data_val_required = " required" })                            
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Assembly<span class="field-validation-valid field-validation-error" data-valmsg-for="ddlAssembly"
      data-valmsg-replace="true">*</span><br />
                            @Html.DropDownList("ddlAssembly", ViewBag.ddlAssembly as SelectList, "Select", 
                           new { @class = "form-control PPATDropdownlist valid", @data_val = "true", @data_val_required = " required" })
                        </td>
                        <td>
                            Mandal<span class="field-validation-valid field-validation-error" data-valmsg-for="ddlMandal"
      data-valmsg-replace="true">*</span><br />
                            @Html.DropDownList("ddlMandal", ViewBag.ddlMandal as SelectList, "Select", 
                           new { @class = "form-control PPATDropdownlist valid", @data_val = "true", @data_val_required = " required" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Village<span class="field-validation-valid field-validation-error" data-valmsg-for="ddlVillage"
      data-valmsg-replace="true">*</span><br />
                            @Html.DropDownList("ddlVillage", ViewBag.ddlVillage as SelectList, "Select", 
                           new { @class = "form-control PPATDropdownlist valid", @data_val = "true", @data_val_required = " required" })
                        </td>
                        <td>
                            PS Name<br />
                            @Html.TextBox("txtPSName", null, new { @class = "form-control PPATtextbox" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            PS Code<span class="field-validation-valid field-validation-error" data-valmsg-for="txtPSCode"
      data-valmsg-replace="true">*</span><br />
                            @Html.TextBox("txtPSCode", null, 
                           new { @class = "form-control PPATtextbox valid", @data_val = "true", @data_val_required = " required" })
                        </td>
                        <td align="center" valign="middle">
                            @*<button name="btnPSGo">GO</button>*@ @*id="@use.userID" Url.Action("Edit","Controller")*@
                            <a href="#" id="btnPSGo">
                                <img alt="go" src="~/Images/btn_go_blue.jpg" height="25px" width="25px" />
                            </a>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td style="height:5px;"></td>
        </tr>
        <tr>
            <td>
                <table border="1" style="width:100%" class="tblRoundCorner">
                    <tr>
                        <td>
                            Name<span class="field-validation-valid field-validation-error" data-valmsg-for="txtUserDisplayName"
      data-valmsg-replace="true">*</span><br />
                            @Html.TextBox("txtUserDisplayName", null, 
                           new { @class = "form-control PPATtextbox valid", @data_val = "true", @data_val_required = " required" })
                        </td>
                        <td>
                            Age<span class="field-validation-valid field-validation-error" data-valmsg-for="txtUserAge"
      data-valmsg-replace="true">*</span><br />
                            @Html.TextBox("txtUserAge", null, 
                           new { @class = "form-control PPATtextbox valid", @data_val = "true", @data_val_required = " required" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Gender<span class="field-validation-valid field-validation-error" data-valmsg-for="ddlGender"
      data-valmsg-replace="true">*</span><br />
                            @Html.DropDownList("ddlGender", ViewBag.ddlGender as SelectList, "Select", 
                           new { @class = "form-control PPATDropdownlist valid", @data_val = "true", @data_val_required = " required" })
                        </td>
                        <td>
                            Mobile<span class="field-validation-valid field-validation-error" data-valmsg-for="txtMobile"
      data-valmsg-replace="true">*</span><br />
                            @Html.TextBox("txtMobile", null, 
                           new { @class = "form-control PPATtextbox valid", @data_val = "true", @data_val_required = " required" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Education<span class="field-validation-valid field-validation-error" data-valmsg-for="ddlEducation"
      data-valmsg-replace="true">*</span><br />
                            @Html.DropDownList("ddlEducation", ViewBag.ddlEducation as SelectList, "Select", 
                           new { @class = "form-control PPATDropdownlist valid", @data_val = "true", @data_val_required = " is required" })
                        </td>
                        <td>
                            Occupation<br />
                            @Html.TextBox("txtOccupation", null, new { @class = "form-control PPATtextbox" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            Community<span class="field-validation-valid field-validation-error" data-valmsg-for="ddlCommunity"
      data-valmsg-replace="true">*</span><br />
                            @Html.DropDownList("ddlCommunity", ViewBag.ddlCommunity as SelectList, "Select", 
                           new { @class = "form-control PPATDropdownlist valid", @data_val = "true", @data_val_required = " required" })
                        </td>
                        <td>
                            Sub Caste<br />
                            @Html.TextBox("txtSubCaste", null, new { @class = "form-control PPATtextbox" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            IF<span class="field-validation-valid field-validation-error" data-valmsg-for="ddlIFParty"
      data-valmsg-replace="true">*</span><br />
                            @Html.DropDownList("ddlIFParty", ViewBag.ddlIFParty as SelectList, "Select", 
                           new { @class = "form-control PPATDropdownlist valid", @data_val = "true", @data_val_required = " required" })
                        </td>
                        <td>
                            SF<span class="field-validation-valid field-validation-error" data-valmsg-for="ddlPPAT_SF"
      data-valmsg-replace="true">*</span><br />
                            @Html.DropDownList("ddlPPAT_SF", ViewBag.ddlPPAT_SF as SelectList, "Select", 
                           new { @class = "form-control PPATDropdownlist valid", @data_val = "true", @data_val_required = " required" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            PRF<span class="field-validation-valid field-validation-error" data-valmsg-for="ddlPPAT_PRF"
      data-valmsg-replace="true">*</span><br />
                            @Html.DropDownList("ddlPPAT_PRF", ViewBag.ddlPPAT_PRF as SelectList, "Select", 
                           new { @class = "form-control PPATDropdownlist valid", @data_val = "true", @data_val_required = " required" })
                        </td>
                        <td>
                            VPF<span class="field-validation-valid field-validation-error" data-valmsg-for="ddlPPAT_VPF"
      data-valmsg-replace="true">*</span><br />
                            @Html.DropDownList("ddlPPAT_VPF", ViewBag.ddlPPAddlPPAT_VPFT_SF as SelectList, "Select", 
                           new { @class = "form-control PPATDropdownlist valid", @data_val = "true", @data_val_required = " required" })
                        </td>
                    </tr>
                    <tr>
                        <td>
                            PIF<span class="field-validation-valid field-validation-error" data-valmsg-for="ddlPPAT_PIF"
      data-valmsg-replace="true">*</span><br />
                            @Html.DropDownList("ddlPPAT_PIF", ViewBag.ddlPPAT_PIF as SelectList, "Select", 
                           new { @class = "form-control PPATDropdownlist valid", @data_val = "true", @data_val_required = " required" })
                        </td>
                        <td>
                            Remarks<br />
                            @Html.TextArea("txtRemarks", string.Empty, 2, 15, null)
                        </td>
                    </tr>
                    <tr>
                        <td colspan="2" align="center">
                            <table id="tblButtons">
                                <tr>
                                    <td>
                                        @*<button id="btnPreview" name="btnPreview" class="btn-sm">Preview</button>*@
                                        @*<input type="submit" name="btnPreview" value="Preview" formaction="PreviewForm" formmethod="post" class="btn-sm" />*@
                                        <input type="submit" id="btnPreview" value="Preview" class="btn-sm" formnovalidate="formnovalidate" />
                                    </td>
                                    <td style="width:5px;"></td>
                                    <td>
                                        @*<button id="btnSave" name="btnSave" class="btn-sm">Save</button>*@
                                        @*<input type="submit" name="btnSave" value="Save" formaction="SaveForm" formmethod="post" class="btn-sm" />*@
                                        <input type="submit" id="btnSave" value="Save" class="btn-sm" />
                                    </td>
                                    <td style="width:5px;"></td>
                                    <td>
                                        @*<button id="btnClear" name="btnClear" class="btn-sm">Clear</button>*@
                                        @*<input type="submit" name="btnClear" value="Clear" formaction="ClearForm" formmethod="post" class="btn-sm" />*@
                                        <input type="submit" id="btnClear" value="Clear" class="btn btn-outline-success border-0 cancel"  />
                                    </td>
                                </tr>
                            </table>
                        </td>

                    </tr>
                </table>
            </td>
        </tr>
    </tbody>
</table>
}